<template name="userProfileEdit">
    <div class="col-md-8">

        <div class="profile-edit user-profile">
            <div class="card">
                {{#autoForm schema=profileSchema id="profileForm" doc=profile type="method" meteormethod="saveProfile"}}
                    <h1>Edit Profile</h1>
                    <!--<button class="btn btn-primary" type="submit">Save changes</button>-->

                    <!--<a href="/profile" class="btn btn-warning" id="bCancel">Cancel</a>-->

                    <div class="about panel panel-default">
                        <div class="panel-heading">
                            About
                        </div>
                        <div class="panel-body">
                            {{> afQuickField name="photoId"
                            previewTemplate='photoImagePreview'
                            selectFileBtnTemplate='selectFileBtn'
                            removeFileBtnTemplate='removeFileBtn'
                            prevUrl=avatarUrl}}

                            {{> afQuickField name="firstName"}}
                            {{> afQuickField name="lastName"}}
                            <div class="form-group">
                                <label for="fCalling" class="control-label">Calling</label>
                                <span class="shadow-text {{#if callingOver}}text-error{{/if}}">{{callingCount}}
                                    /140</span>
                                {{> afFieldInput id="fCalling" name="calling"}}
                                <span class="help-block"></span>
                            </div>
                            <div class="form-group">
                                <label for="fSummary" class="control-label">Summary</label>
                                <span class="shadow-text {{#if summaryOver}}text-error{{/if}}">
                                    {{summaryCount}}/2500</span>
                                {{> afFieldInput id="fSummary" name="summary" value=profile.summary}}
                                <span class="help-block"></span>
                            </div>

                        </div>
                    </div>
                    {{> afQuickField name="links"}}


                    <button class="btn btn-primary" type="submit">Save changes</button>
                    <a href="/profile" class="btn btn-warning" id="bCancel">Cancel</a>

                {{/autoForm}}
            </div>
            <div class="education card">
                <h2>Education</h2>
                {{#each profile.education}}
                    <div class="school panel panel-default">
                        {{#if isEducationEdit id}}
                            <div class="panel-heading">Edit education</div>
                            <div class="panel-body">
                                {{#autoForm doc=this schema=educationSchema
                                type="method-update" id="editEducation" meteormethod="editEducation"}}
                                    {{> afQuickFields}}
                                    <div>
                                        <button type="submit" class="btn btn-primary">Save</button>
                                        <button type="button" class="btn btn-default b-education-cancel">Cancel</button>
                                    </div>
                                {{/autoForm}}
                            </div>
                        {{else}}
                            <div class="panel-body">
                                <div class="name">
                                    {{schoolName}}
                                    {{#if gradeYear}} Â· {{gradeYear}}{{/if}}
                                </div>
                                {{#if fieldOfStudy}}
                                    <div class="field">{{fieldOfStudy}}</div>
                                {{/if}}
                                <div>
                                    <button class="btn btn-primary b-education-edit" data-id="{{id}}">Edit</button>
                                    <button class="btn btn-danger b-education-remove" data-id="{{id}}">Remove</button>
                                </div>
                            </div>
                        {{/if}}

                    </div>
                {{/each}}
                <div class="panel panel-default">
                    <div class="panel-heading">Add education</div>
                    <div class="panel-body">
                        {{> quickForm schema=educationSchema buttonContent="Save"
                        type="method" id="addEducation" meteormethod="addEducation"}}
                    </div>
                </div>
            </div>
        </div>

    </div>
</template>


<template name="photoImagePreview">
    <div class="avatar-preview">
        <img src="{{file.url}}">
    </div>
</template>

<template name="selectFileBtn">
    <div class="avatar-preview">
        <img src="{{url}}">
    </div>
    <button type="button" class="btn btn-default af-select-file js-af-select-file">
        Choose file
        <input type="file" class="js-file">
    </button>
</template>

<template name="removeFileBtn">
    <!--It's removed because here the BUG with second upload-->
</template>
